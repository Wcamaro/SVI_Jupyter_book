
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Plot an Ensemble of CMIP6 Climate Projections &#8212; Copernicus Climate Change Service (C3S) Training Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/projections-cmip6/projections-cmip6';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Analysis of Projected versus Historical Climatology with CORDEX Data" href="../projections-cordex/projections-cordex.html" />
    <link rel="prev" title="Climate Projections Tutorial" href="../../notebook-groups/climate-projections-tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is a TEST Version, this is not an official website‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Copernicus Climate Change Service (C3S) Training Book</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Copernicus Climate Change Service (C3S) Data Tutorials
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://climate.copernicus.eu/">Copernicus Climate Change Service (C3S)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cds.climate.copernicus.eu/">Copernicus Climate Data Store (CDS)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://climate.copernicus.eu/user-learning-services/">C3S Training Services</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../how-to-run-these-tutorials.html">How to run these tutorials</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebook-groups/cds-tutorial.html">CDS tutorial</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../cds-tutorial/cds-tutorial.html">CDS tutorial</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebook-groups/reanalysis-tutorial.html">Reanalysis tutorial</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../reanalysis-climatology/reanalysis-climatology.html">Climatology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reanalysis-heatwave/reanalysis-heatwave.html">Heatwave Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../notebook-groups/climate-projections-tutorial.html">Climate Projections tutorial</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Climate Projections (CMIP6)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projections-cordex/projections-cordex.html">Climate Projections (CORDEX)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebook-groups/seasonal-forecasts-tutorial.html">Seasonal Forecasts tutorial</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../sf-anomalies/sf-anomalies.html">Seasonal Forecast Anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sf-verification/sf-verification.html">Seasonal Forecast Verification</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebook-groups/climate-indices-tutorial.html">Climate Indices tutorial</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ci-windchill/ci-windchill.html">Windchill</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebook-groups/satellite-observations-tutorial.html">Satellite Observations tutorial</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../notebook-groups/erb.html">Earth Radiation Budget</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../erb-outgoing-longwave-radiation/erb-outgoing-longwave-radiation.html">Outgoing Longwave Radiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../erb-clara-climatology/erb-clara-climatology.html">Analysis of the CLARA Earth radiation budget product</a></li>
<li class="toctree-l3"><a class="reference internal" href="../erb-ceres-climatology/erb-ceres-climatology.html">Analysis of the CERES Earth radiation budget product</a></li>
<li class="toctree-l3"><a class="reference internal" href="../total-solar-irradiance/total-solar-irradiance.html">Total Solar Irradiance</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../notebook-groups/srb.html">Surface Radiation Budget</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../srb-climatology-and-anomaly/srb-climatology-and-anomaly.html">Surface radiation budget climatologies and anomalies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../notebook-groups/atmos-humidity-cloud.html">Atmospheric Humidity and Cloud</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../total-column-water-vapour-combi/total-column-water-vapour-combi.html">Total column water vapour</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tropospheric-humidity-from-radio-occultation/tropospheric-humidity-from-radio-occultation.html">Tropospheric humidity estimates from satellite-based radio occultation measurements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cloud-cover-climatology/cloud-cover-climatology.html">Cloud fractional cover climatology</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../notebook-groups/atmos-composition.html">Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../greenhouse-gases-level2-products/greenhouse-gases-level2-products.html">Greenhouse Gas Level 2 Products</a></li>
<li class="toctree-l3"><a class="reference internal" href="../greenhouse-gases-level3-products/greenhouse-gases-level3-products.html">Greenhouse Gas Level 3 Products</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aerosol-single-sensor-demonstrator/aerosol-single-sensor-demonstrator.html">C3S Aerosol</a></li>



<li class="toctree-l3"><a class="reference internal" href="../aerosol-multi-sensor-record/aerosol-multi-sensor-record.html">Aerosol Multi-Sensor Record</a></li>
<li class="toctree-l3"><a class="reference internal" href="../total-ozone-columns/total-ozone-columns.html">Total Ozone Columns</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../notebook-groups/surface-water.html">Surface Water</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../soil-moisture-anomalies/soil-moisture-anomalies.html">Soil Moisture Anomaly Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lake-water-level/lake-water-level.html">Tutorial: Visualising Lake Water Level (LWL) timeseries</a></li>




<li class="toctree-l3"><a class="reference internal" href="../lake-surface-water-temperature/lake-surface-water-temperature.html">Lake Surface Water Temperature Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../notebook-groups/ice-sheets.html">Ice Sheets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../ice-sheet-surface-elevation/ice-sheet-surface-elevation.html">Ice Sheet Surface Elevation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ice-sheet-velocity/ice-sheet-velocity.html">Ice Sheet Velocity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ice-sheet-mass-balance/ice-sheet-mass-balance.html">Ice Sheet Mass Balance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../glacier-mass-change/glacier-mass-change.html">Glacier Mass Change</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebook-groups/copernicus-emergency-service-tutorial.html">Tutorials using Copernicus Emergency Management Service data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualising-fwi-for-esotc/visualising-fwi-for-esotc.html">Visualising fire weather index (FWI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../glofas-bangladesh-floods/glofas-bangladesh-floods.html">Observing major flood events</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Explore other booksüìö</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://Randbee.github.io/CAMSBook">Copernicus Atmosphere Monitoring Service (CAMS) Data Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://ecmwfcode4earth.github.io/sketchbook-earth">Sketchbook Earth - A collection of Jupyter notebooks for Earth Sciences</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ECMWF</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../support.html">Help&amp;Support</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/Randbee/C3SBook/review?urlpath=tree/notebooks/projections-cmip6/projections-cmip6.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Randbee/C3SBook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Randbee/C3SBook/issues/new?title=Issue%20on%20page%20%2Fnotebooks/projections-cmip6/projections-cmip6.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/projections-cmip6/projections-cmip6.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Plot an Ensemble of CMIP6 Climate Projections</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning objectives üß†</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#target-audience">Target audience üéØ</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites-and-assumed-knowledge">Prerequisites and assumed knowledge üîç</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outline">Outline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-the-necessary-libraries">1. Import the necessary libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#access-data-with-the-cds-api">2. Access data with the CDS API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unzip-the-downloaded-data-files">3. Unzip the downloaded data files</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-list-of-the-extracted-files">Create a list of the extracted files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-prepare-cmip6-data-for-one-model-and-one-experiment">4. Load and prepare CMIP6 data for one model and one experiment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-load-and-inspect-data">4.A. Load and inspect data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-spatial-aggregation">4.B. Spatial aggregation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-temporal-aggregation">4.C. Temporal aggregation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-conversion-from-kelvin-to-celsius">4.D. Conversion from Kelvin to Celsius</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-create-additional-data-dimensions">4.E. Create additional data dimensions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-prepare-cmip6-data-for-all-models-and-experiments">5. Load and prepare CMIP6 data for all models and experiments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-cmip6-annual-global-average-temperature-between-1850-to-2100">6. Visualize the CMIP6 annual global average temperature between 1850 to 2100</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-calculate-quantiles-for-model-ensemble">6.A. Calculate quantiles for model ensemble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-view-time-series">6.B. View time-series</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-messages-to-take-home">Key Messages to Take Home üìå</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S16.png" /></p>
<br><section class="tex2jax_ignore mathjax_ignore" id="plot-an-ensemble-of-cmip6-climate-projections">
<h1>Plot an Ensemble of CMIP6 Climate Projections<a class="headerlink" href="#plot-an-ensemble-of-cmip6-climate-projections" title="Link to this heading">#</a></h1>
<p>This notebook provides a practical introduction on how to access and process <a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/projections-cmip6?tab=overview">CMIP6 global climate projections</a> data available in the <a class="reference external" href="https://cds.climate.copernicus.eu/">Climate Data Store (CDS)</a> of the <a class="reference external" href="https://climate.copernicus.eu/">Copernicus Climate Change Service (C3S)</a>. The workflow shows how to compute and visualize the output of an ensemble of models for the annual global average temperature between 1850 to 2100. You will use the <code class="docutils literal notranslate"><span class="pre">historical</span></code> experiment for the temporal period 1850 to 2014 and the three scenarios <code class="docutils literal notranslate"><span class="pre">SSP1-2.6</span></code>, <code class="docutils literal notranslate"><span class="pre">SSP2-4.5</span></code> and <code class="docutils literal notranslate"><span class="pre">SSP5-8.5</span></code> for the period from 2015 to 2100.</p>
<p>Learn <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/CMIP6%3A+Global+climate+projections#CMIP6:Globalclimateprojections">here</a> more about CMIP6 global climate projections and the CMIP6 experiments in the CDS.</p>
<div class="alert alert-block alert-success">
    <b>NOTE</b>: </br>
    For the sake of simplicity, and to facilitate data download, the tutorial will make use of some of the coarser resolution models that have a smaller data size. It is nevertheless only a choice for this exercise and <b>not a recommendation</b> (since ideally all models, including those with highest resolution, should be used). Many more models are available on the CDS, and when calculating an ensemble of models, <b>it is best practice to use as many as possible for a more reliable output</b>. See <a href="https://confluence.ecmwf.int/display/CKB/CMIP6%3A+Global+climate+projections#CMIP6:Globalclimateprojections-Models,gridsandpressurelevels">here </a> a full list of models included in the CDS-CMIP6 dataset.</div><hr><section id="learning-objectives">
<h2>Learning objectives üß†<a class="headerlink" href="#learning-objectives" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Learn to compute a model ensemble and visualize its output.</p></li>
</ol>
<hr></section>
<section id="target-audience">
<h2>Target audience üéØ<a class="headerlink" href="#target-audience" title="Link to this heading">#</a></h2>
<p><strong>Anyone</strong> interested in learning how to predicting climate variables through the use of model ensembles.</p>
<hr></section>
<section id="prerequisites-and-assumed-knowledge">
<h2>Prerequisites and assumed knowledge üîç<a class="headerlink" href="#prerequisites-and-assumed-knowledge" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Programming Skills</strong>: Familiarity with programming concepts, particularly in Python, as the tutorial involves using loops, defining functions and using multiple different libraries for data manipulation and visualization.</p></li>
<li><p><strong>Familiarity with API Usage</strong>: Understanding of how to use Application Programming Interfaces (APIs) will be useful for accessing data through the CDS API.</p></li>
<li><p><strong>Familiarity with multidimensional data structure</strong>: Comprehending what are data dimensions and how they are organized in an array will be helpful.</p></li>
<li><p><strong>Familiarity with the concept of model ensembling</strong>: check <a class="reference external" href="https://learning.ecmwf.int/mod/scorm/player.php?a=170&amp;amp;currentorg=Ensemble_Forecasting_ORG&amp;amp;scoid=440">this C3S module</a> to learn more about model ensembles.</p></li>
</ol>
<hr><div class="tip admonition">
<p class="admonition-title">Difficulty</p>
<p>3/5</p>
</div>
<hr><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3" open="open">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Run the tutorial</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<h3 class="rubric" id="wekeo">WEKEO</h3>
<p class="sd-card-text"><a class="reference external" href="https://www.wekeo.eu/">WEkEO</a> serves as the official platform of the European Centre for Medium-Range Weather Forecasts (ECMWF), offering access to an extensive array of climate data and tools for analysis and visualization. It provides a robust environment for conducting in-depth analysis and exploration of climate-related datasets. To learn more about WEkEO and its offerings, visit their <a class="reference external" href="https://www.wekeo.eu/">website</a>.</p>
<p class="sd-card-text"><a class="reference external" href="https://www.wekeo.eu/">Run this notebook on WEKEO</a></p>
<h3 class="rubric" id="possible-cloud-services">Possible Cloud Services</h3>
<p class="sd-card-text">While Kaggle, Binder, and Colab are popular options for running notebooks in the cloud, it‚Äôs essential to note that these are just a few among many available choices. Each platform has its unique features and capabilities, catering to diverse user needs and preferences.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p class="sd-card-text"><strong>Kaggle</strong></p></th>
<th class="head text-center"><p class="sd-card-text"><strong>Binder</strong></p></th>
<th class="head text-center"><p class="sd-card-text"><strong>Colab</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p class="sd-card-text"><a class="reference external" href="https://kaggle.com/kernels/welcome?src=https://github.com/Randbee/projections-cmip6/blob/master/projections-cmip6.ipynb"><img alt="Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg" /></a></p></td>
<td class="text-center"><p class="sd-card-text"><a class="reference external" href="https://mybinder.org/v2/gh/Randbee/projections-cmip6/master?labpath=projections-cmip6.ipynb"><img alt="Binder" src="https://mybinder.org/badge.svg" /></a></p></td>
<td class="text-center"><p class="sd-card-text"><a class="reference external" href="https://colab.research.google.com/github/Randbee/projections-cmip6/blob/master/projections-cmip6.ipynb"><img alt="Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details><hr></section>
<section id="outline">
<h2>Outline<a class="headerlink" href="#outline" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Import the necessary libraries</p></li>
<li><p>Access data with the CDS API</p></li>
<li><p>Unzip the downloaded data files</p></li>
<li><p>Load and prepare CMIP6 data for one model and one experiment</p>
<ol class="arabic simple">
<li><p>Load and inspect data</p></li>
<li><p>Spatial aggregation</p></li>
<li><p>Temporal aggregation</p></li>
<li><p>Conversion from Keelvin to Celsius</p></li>
<li><p>Creation of additional data dimensions</p></li>
</ol>
</li>
<li><p>Load and prepare CMIP6 data for all models and experiments</p></li>
<li><p>Visualize CMIP6 annual global average temperature between 1850 to 2100</p>
<ol class="arabic simple">
<li><p>Calculate quantiles for model ensemble</p></li>
<li><p>View time-series</p></li>
</ol>
</li>
</ol>
<hr></section>
<section id="import-the-necessary-libraries">
<h2>1. Import the necessary libraries<a class="headerlink" href="#import-the-necessary-libraries" title="Link to this heading">#</a></h2>
<p>For downloading the data from the CDS we will need <a class="reference external" href="https://pypi.org/project/cdsapi/">cdsapi</a>. We will be working with data in NetCDF format. To best handle this data we will use libraries for working with multidimensional arrays, in particular <a class="reference external" href="https://docs.xarray.dev/en/stable/">xarray</a>, and <a class="reference external" href="https://pandas.pydata.org/">pandas</a> to work with dataframes. We will also need libraries for plotting and viewing data, in this case we will use <a class="reference external" href="https://matplotlib.org/">matplotlib</a> and <a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/">cartopy</a>.
If you don‚Äôt have any of the following libraries, you must install it. You can do it like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>dask
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting dask
  Downloading dask-2024.6.2-py3-none-any.whl.metadata (3.8 kB)
Requirement already satisfied: click&gt;=8.1 in /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages (from dask) (8.1.7)
Collecting cloudpickle&gt;=1.5.0 (from dask)
  Downloading cloudpickle-3.0.0-py3-none-any.whl.metadata (7.0 kB)
Collecting fsspec&gt;=2021.09.0 (from dask)
  Downloading fsspec-2024.6.0-py3-none-any.whl.metadata (11 kB)
Requirement already satisfied: packaging&gt;=20.0 in /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages (from dask) (23.2)
Collecting partd&gt;=1.2.0 (from dask)
  Downloading partd-1.4.2-py3-none-any.whl.metadata (4.6 kB)
Requirement already satisfied: pyyaml&gt;=5.3.1 in /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages (from dask) (6.0.1)
Collecting toolz&gt;=0.10.0 (from dask)
  Downloading toolz-0.12.1-py3-none-any.whl.metadata (5.1 kB)
Collecting locket (from partd&gt;=1.2.0-&gt;dask)
  Downloading locket-1.0.0-py2.py3-none-any.whl.metadata (2.8 kB)
Downloading dask-2024.6.2-py3-none-any.whl (1.2 MB)
   ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ <span class=" -Color -Color-Green">1.2/1.2 MB</span> <span class=" -Color -Color-Red">5.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>00:0100:01
?25hDownloading cloudpickle-3.0.0-py3-none-any.whl (20 kB)
Downloading fsspec-2024.6.0-py3-none-any.whl (176 kB)
   ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ <span class=" -Color -Color-Green">176.9/176.9 kB</span> <span class=" -Color -Color-Red">6.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading partd-1.4.2-py3-none-any.whl (18 kB)
Downloading toolz-0.12.1-py3-none-any.whl (56 kB)
   ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ <span class=" -Color -Color-Green">56.1/56.1 kB</span> <span class=" -Color -Color-Red">5.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading locket-1.0.0-py2.py3-none-any.whl (4.4 kB)
Installing collected packages: toolz, locket, fsspec, cloudpickle, partd, dask
Successfully installed cloudpickle-3.0.0 dask-2024.6.2 fsspec-2024.6.0 locket-1.0.0 partd-1.4.2 toolz-0.12.1

<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">24.0</span> -&gt; <span class=" -Color -Color-Green">24.1.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
</div>
</div>
<p>If you need to install dask, then you must <strong>restart your Kernel</strong> before continuing. For that, go the the <code class="docutils literal notranslate"><span class="pre">Kernel</span></code> tab above.</p>
<div class="alert alert-block alert-success">
<b>NOTE</b>: <br>
    Note the exclamation mark in the line of code above. This means the code will run as a shell (as opposed to a notebook) command.</div><div class="alert alert-block alert-success">
<b>NOTE</b>: <br>
    If you are having trouble to work with the xarray library, check the C3S tutorial on climatologies for detailed help.</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># General libs for file paths, data extraction, etc</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">basename</span>
<span class="kn">import</span> <span class="nn">zipfile</span> <span class="c1"># To extract zipfiles</span>
<span class="kn">import</span> <span class="nn">urllib3</span> 
<span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span> <span class="c1"># Disable warnings for data download via API</span>

<span class="c1"># CDS API</span>
<span class="kn">import</span> <span class="nn">cdsapi</span>

<span class="c1"># Libraries for working with multi-dimensional arrays</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">dask</span>

<span class="c1"># Libraries for plotting and visualising data</span>
<span class="kn">import</span> <span class="nn">matplotlib.path</span> <span class="k">as</span> <span class="nn">mpath</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
</pre></div>
</div>
</div>
</div>
<hr></section>
<section id="access-data-with-the-cds-api">
<h2>2. Access data with the CDS API<a class="headerlink" href="#access-data-with-the-cds-api" title="Link to this heading">#</a></h2>
<p>To access data from the CDS, you will need first to <a class="reference external" href="https://cds.climate.copernicus.eu/#!/home">register</a> at the ADS registration page (if you haven‚Äôt already done so), <a class="reference external" href="https://cds.climate.copernicus.eu/user/login">log in</a>, and accept the Terms and Conditions at the end of the <code class="docutils literal notranslate"><span class="pre">Download</span> <span class="pre">data</span></code> tab.<br></p>
<p>To obtain data programmatically from the CDS, you will need an API Key that can be found in the <a class="reference external" href="https://cds.climate.copernicus.eu/api-how-to">api-how-to page</a>. Here your key will appear automatically in the black window, assuming you have already registered and logged into the ADS. Your API key is the entire string of characters that appears after <code class="docutils literal notranslate"><span class="pre">key:</span></code></p>
<p>Now copy your API key into the code cell below, replacing <code class="docutils literal notranslate"><span class="pre">#######</span></code> with your key.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;https://cds.climate.copernicus.eu/api/v2&#39;</span>
<span class="n">KEY</span> <span class="o">=</span> <span class="s1">&#39;##################################&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Here we specify a data directory in which we will download our data and all output files that we will generate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATADIR</span> <span class="o">=</span> <span class="s1">&#39;./&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>The next step is then to request the data with the help of the CDS API. Below, we loop through multiple data requests. These include data for different models and scenarios. It is not possible to specify multiple models in one data request as their spatial resolution varies.</p>
<p>We will download monthly aggregated data. These are disseminated as netcdf files within a zip archive.</p>
<p>In order to loop through the various experiments and models in our data requests, we will specify them as Python ‚Äòlists‚Äô here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">experiments</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;historical&#39;</span><span class="p">,</span> <span class="s1">&#39;ssp126&#39;</span><span class="p">,</span> <span class="s1">&#39;ssp245&#39;</span><span class="p">,</span> <span class="s1">&#39;ssp585&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hadgem3_gc31_ll&#39;</span><span class="p">,</span> <span class="s1">&#39;inm_cm5_0&#39;</span><span class="p">,</span> <span class="s1">&#39;inm_cm4_8&#39;</span><span class="p">,</span> <span class="s1">&#39;ipsl_cm6a_lr&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;miroc_es2l&#39;</span><span class="p">,</span> <span class="s1">&#39;mpi_esm1_2_lr&#39;</span><span class="p">,</span> <span class="s1">&#39;ukesm1_0_ll&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-success">
    <b>NOTE</b>: </br>
    Note that these are a selection of the lightest models (in terms of data volume), to facilitate download for the sake of this exercise. There are many <a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/projections-cmip6?tab=overview">more models available on the CDS</a>.</div><p>Now we can download the data for each model and experiment sequentially. We will do this separately for the historical experiments and for the various future scenarios, given that they refer to two different time periods.
In the <code class="docutils literal notranslate"><span class="pre">Download</span> <span class="pre">data</span></code> tab, we will select the following parameters to download:</p>
<ul class="simple">
<li><p><strong>Data</strong>: <code class="docutils literal notranslate"><span class="pre">CMIP6</span> <span class="pre">global</span> <span class="pre">climate</span> <span class="pre">projections</span> <span class="pre">of</span> <span class="pre">near-surface</span> <span class="pre">air</span> <span class="pre">temperature</span></code><br></p></li>
<li><p><strong>Experiments</strong>: <code class="docutils literal notranslate"><span class="pre">Historical</span></code>, <code class="docutils literal notranslate"><span class="pre">SSP1-2.6</span></code>, <code class="docutils literal notranslate"><span class="pre">SSP2-4.5</span></code>, <code class="docutils literal notranslate"><span class="pre">SSP5-8.5</span></code> <br></p></li>
<li><p><strong>Models</strong>: 7 models from Germany, France, UK, Japan and Russia represented in the <code class="docutils literal notranslate"><span class="pre">models</span></code> list <br></p></li>
<li><p><strong>Temporal range</strong>: Historical: <code class="docutils literal notranslate"><span class="pre">1850</span> <span class="pre">-</span> <span class="pre">2014</span></code>. Scenarios: <code class="docutils literal notranslate"><span class="pre">2015</span> <span class="pre">-</span> <span class="pre">2100</span></code> <br></p></li>
<li><p><strong>Spatial coverage</strong>: <code class="docutils literal notranslate"><span class="pre">Global</span></code> <br></p></li>
<li><p><strong>Format</strong>: <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code>, compressed into zip files</p></li>
</ul>
<p>And this is the time when you must accept the Terms and Conditions that are at the bottom of this page.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># DOWNLOAD DATA FOR HISTORICAL PERIOD</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">URL</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">KEY</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
    <span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
        <span class="s1">&#39;projections-cmip6&#39;</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;zip&#39;</span><span class="p">,</span>
            <span class="s1">&#39;temporal_resolution&#39;</span><span class="p">:</span> <span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
            <span class="s1">&#39;experiment&#39;</span><span class="p">:</span> <span class="s1">&#39;historical&#39;</span><span class="p">,</span>
            <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;single_levels&#39;</span><span class="p">,</span>
            <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;near_surface_air_temperature&#39;</span><span class="p">,</span>
            <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;1850-01-01/2014-12-31&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">cmip6_monthly_1850-2014_historical_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-06-27 11:14:26,491 INFO Welcome to the CDS
2024-06-27 11:14:26,492 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:14:26,702 INFO Request is queued
2024-06-27 11:14:27,758 INFO Request is running
2024-06-27 11:14:40,168 INFO Request is completed
2024-06-27 11:14:40,169 INFO Downloading https://download-0000-clone.copernicus-climate.eu/cache-compute-0000/cache/data8/adaptor.esgf_wps.retrieve-1719479674.075813-9693-6-cdc6b06e-2328-4f58-943a-996154993c91.zip to ./cmip6_monthly_1850-2014_historical_hadgem3_gc31_ll.zip (114.1M)
2024-06-27 11:15:03,120 INFO Download rate 5M/s                                 
2024-06-27 11:15:03,220 INFO Welcome to the CDS
2024-06-27 11:15:03,222 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:15:03,457 INFO Request is queued
2024-06-27 11:15:04,514 INFO Request is running
2024-06-27 11:15:16,922 INFO Request is completed
2024-06-27 11:15:16,924 INFO Downloading https://download-0015-clone.copernicus-climate.eu/cache-compute-0015/cache/data7/adaptor.esgf_wps.retrieve-1719479707.7181854-27329-16-e2535f7a-94c7-4e7c-85d2-6f0c5c1d62fb.zip to ./cmip6_monthly_1850-2014_historical_inm_cm5_0.zip (96.5M)
2024-06-27 11:15:34,964 INFO Download rate 5.3M/s                               
2024-06-27 11:15:35,061 INFO Welcome to the CDS
2024-06-27 11:15:35,062 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:15:35,252 INFO Request is queued
2024-06-27 11:15:36,306 INFO Request is running
2024-06-27 11:15:48,714 INFO Request is completed
2024-06-27 11:15:48,716 INFO Downloading https://download-0011-clone.copernicus-climate.eu/cache-compute-0011/cache/data5/adaptor.esgf_wps.retrieve-1719479739.5302129-29743-15-90c652dc-d2dd-4a1a-ae1a-75d2e0915ab7.zip to ./cmip6_monthly_1850-2014_historical_inm_cm4_8.zip (96.6M)
2024-06-27 11:16:11,268 INFO Download rate 4.3M/s                               
2024-06-27 11:16:11,366 INFO Welcome to the CDS
2024-06-27 11:16:11,367 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:16:11,548 INFO Request is queued
2024-06-27 11:16:12,599 INFO Request is running
2024-06-27 11:16:25,021 INFO Request is completed
2024-06-27 11:16:25,023 INFO Downloading https://download-0009-clone.copernicus-climate.eu/cache-compute-0009/cache/data9/adaptor.esgf_wps.retrieve-1719479778.9748197-5265-11-b9635f55-9383-4cfa-9caa-bcb97d3da2aa.zip to ./cmip6_monthly_1850-2014_historical_ipsl_cm6a_lr.zip (91.1M)
2024-06-27 11:16:50,378 INFO Download rate 3.6M/s                               
2024-06-27 11:16:50,476 INFO Welcome to the CDS
2024-06-27 11:16:50,477 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:16:50,630 INFO Request is queued
2024-06-27 11:16:51,686 INFO Request is running
2024-06-27 11:17:04,098 INFO Request is completed
2024-06-27 11:17:04,100 INFO Downloading https://download-0009-clone.copernicus-climate.eu/cache-compute-0009/cache/data2/adaptor.esgf_wps.retrieve-1719479817.999824-31091-12-538377db-2c13-4b86-abd6-5c10567a798a.zip to ./cmip6_monthly_1850-2014_historical_miroc_es2l.zip (35.7M)
2024-06-27 11:17:15,669 INFO Download rate 3.1M/s                               
2024-06-27 11:17:15,763 INFO Welcome to the CDS
2024-06-27 11:17:15,765 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:17:15,917 INFO Request is queued
2024-06-27 11:17:16,976 INFO Request is running
2024-06-27 11:17:37,037 INFO Request is completed
2024-06-27 11:17:37,038 INFO Downloading https://download-0019.copernicus-climate.eu/cache-compute-0019/cache/data4/adaptor.esgf_wps.retrieve-1719479843.4658937-5221-9-cab367d2-e85c-4064-89ce-79efad3e9884.zip to ./cmip6_monthly_1850-2014_historical_mpi_esm1_2_lr.zip (63.6M)
2024-06-27 11:17:55,857 INFO Download rate 3.4M/s                               
2024-06-27 11:17:55,955 INFO Welcome to the CDS
2024-06-27 11:17:55,956 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:17:56,138 INFO Request is queued
2024-06-27 11:17:57,195 INFO Request is running
2024-06-27 11:18:17,257 INFO Request is completed
2024-06-27 11:18:17,259 INFO Downloading https://download-0015-clone.copernicus-climate.eu/cache-compute-0015/cache/data6/adaptor.esgf_wps.retrieve-1719479880.5541074-28012-15-ec1c2211-614a-4522-8ca3-e1e67b51b576.zip to ./cmip6_monthly_1850-2014_historical_ukesm1_0_ll.zip (220.4M)
2024-06-27 11:19:59,819 INFO Download rate 2.1M/s                               
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># DOWNLOAD DATA FOR FUTURE SCENARIOS</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">URL</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">KEY</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">experiments</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
        <span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
            <span class="s1">&#39;projections-cmip6&#39;</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;zip&#39;</span><span class="p">,</span>
                <span class="s1">&#39;temporal_resolution&#39;</span><span class="p">:</span> <span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                <span class="s1">&#39;experiment&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;single_levels&#39;</span><span class="p">,</span>
                <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;near_surface_air_temperature&#39;</span><span class="p">,</span>
                <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;2015-01-01/2100-12-31&#39;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">cmip6_monthly_2015-2100_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-06-27 11:20:00,085 INFO Welcome to the CDS
2024-06-27 11:20:00,087 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:20:00,333 INFO Request is queued
2024-06-27 11:20:01,383 INFO Request is running
2024-06-27 11:20:13,781 INFO Request is completed
2024-06-27 11:20:13,783 INFO Downloading https://download-0013-clone.copernicus-climate.eu/cache-compute-0013/cache/data6/adaptor.esgf_wps.retrieve-1719480004.7341053-31229-17-13ab3c16-cb97-43ee-aee3-ffd20a5afb17.zip to ./cmip6_monthly_2015-2100_ssp126_hadgem3_gc31_ll.zip (55.4M)
2024-06-27 11:20:26,611 INFO Download rate 4.3M/s                               
2024-06-27 11:20:26,699 INFO Welcome to the CDS
2024-06-27 11:20:26,700 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:20:26,837 INFO Request is queued
2024-06-27 11:20:27,889 INFO Request is running
2024-06-27 11:20:35,174 INFO Request is completed
2024-06-27 11:20:35,175 INFO Downloading https://download-0002-clone.copernicus-climate.eu/cache-compute-0002/cache/data0/adaptor.esgf_wps.retrieve-1719480031.1480098-16398-8-1f690240-8e0a-4cbb-9462-3eb8e5c13050.zip to ./cmip6_monthly_2015-2100_ssp126_inm_cm5_0.zip (50.3M)
2024-06-27 11:20:46,185 INFO Download rate 4.6M/s                               
2024-06-27 11:20:46,275 INFO Welcome to the CDS
2024-06-27 11:20:46,276 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:20:46,425 INFO Request is queued
2024-06-27 11:20:47,481 INFO Request is running
2024-06-27 11:20:59,874 INFO Request is completed
2024-06-27 11:20:59,876 INFO Downloading https://download-0012-clone.copernicus-climate.eu/cache-compute-0012/cache/data5/adaptor.esgf_wps.retrieve-1719480050.6298327-3184-6-69a9257e-4a32-4670-b833-63140f96c60f.zip to ./cmip6_monthly_2015-2100_ssp126_inm_cm4_8.zip (50.2M)
2024-06-27 11:21:13,916 INFO Download rate 3.6M/s                               
2024-06-27 11:21:14,007 INFO Welcome to the CDS
2024-06-27 11:21:14,008 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:21:14,235 INFO Downloading https://download-0007-clone.copernicus-climate.eu/cache-compute-0007/cache/data6/adaptor.esgf_wps.retrieve-1713814342.9141424-17489-18-96548268-d366-4593-aa85-337834028fba.zip to ./cmip6_monthly_2015-2100_ssp126_ipsl_cm6a_lr.zip (47.4M)
2024-06-27 11:21:26,144 INFO Download rate 4M/s                                 
2024-06-27 11:21:26,232 INFO Welcome to the CDS
2024-06-27 11:21:26,233 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:21:26,413 INFO Request is queued
2024-06-27 11:21:27,465 INFO Request is running
2024-06-27 11:21:34,739 INFO Request is completed
2024-06-27 11:21:34,741 INFO Downloading https://download-0017.copernicus-climate.eu/cache-compute-0017/cache/data4/adaptor.esgf_wps.retrieve-1719480090.6684303-30947-9-aed2cf91-c3c2-4aa3-88bd-a187a939486e.zip to ./cmip6_monthly_2015-2100_ssp126_miroc_es2l.zip (18.7M)
2024-06-27 11:21:40,502 INFO Download rate 3.2M/s                               
2024-06-27 11:21:40,591 INFO Welcome to the CDS
2024-06-27 11:21:40,592 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:21:40,758 INFO Request is queued
2024-06-27 11:21:41,812 INFO Request is running
2024-06-27 11:21:49,093 INFO Request is completed
2024-06-27 11:21:49,094 INFO Downloading https://download-0000-clone.copernicus-climate.eu/cache-compute-0000/cache/data4/adaptor.esgf_wps.retrieve-1719480105.070986-8727-19-4c5e33b6-6197-4700-9a62-0314dde5b784.zip to ./cmip6_monthly_2015-2100_ssp126_mpi_esm1_2_lr.zip (33.2M)
2024-06-27 11:21:55,163 INFO Download rate 5.5M/s                               
2024-06-27 11:21:55,253 INFO Welcome to the CDS
2024-06-27 11:21:55,254 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:21:55,439 INFO Request is queued
2024-06-27 11:21:56,495 INFO Request is running
2024-06-27 11:22:03,776 INFO Request is completed
2024-06-27 11:22:03,777 INFO Downloading https://download-0013-clone.copernicus-climate.eu/cache-compute-0013/cache/data8/adaptor.esgf_wps.retrieve-1719480119.6222765-523-11-b1fa430c-e73f-40b7-9f07-facaa41bb2c9.zip to ./cmip6_monthly_2015-2100_ssp126_ukesm1_0_ll.zip (63.4M)
2024-06-27 11:22:14,656 INFO Download rate 5.8M/s                               
2024-06-27 11:22:14,747 INFO Welcome to the CDS
2024-06-27 11:22:14,748 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:22:14,896 INFO Request is queued
2024-06-27 11:22:15,950 INFO Request is running
2024-06-27 11:22:35,989 INFO Request is completed
2024-06-27 11:22:35,991 INFO Downloading https://download-0004-clone.copernicus-climate.eu/cache-compute-0004/cache/data7/adaptor.esgf_wps.retrieve-1719480139.1795943-3688-18-026840af-df82-4619-aced-941752a3dee7.zip to ./cmip6_monthly_2015-2100_ssp245_hadgem3_gc31_ll.zip (55.3M)
2024-06-27 11:22:47,645 INFO Download rate 4.7M/s                               
2024-06-27 11:22:47,734 INFO Welcome to the CDS
2024-06-27 11:22:47,735 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:22:47,977 INFO Downloading https://download-0021.copernicus-climate.eu/cache-compute-0021/cache/data6/adaptor.esgf_wps.retrieve-1710206192.4122436-25800-9-aafc87a7-acf1-47e1-be3d-9865394cee76.zip to ./cmip6_monthly_2015-2100_ssp245_inm_cm5_0.zip (50.2M)
2024-06-27 11:23:09,531 INFO Download rate 2.3M/s                               
2024-06-27 11:23:09,619 INFO Welcome to the CDS
2024-06-27 11:23:09,621 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:23:09,769 INFO Request is queued
2024-06-27 11:23:10,826 INFO Request is running
2024-06-27 11:23:18,107 INFO Request is completed
2024-06-27 11:23:18,109 INFO Downloading https://download-0010-clone.copernicus-climate.eu/cache-compute-0010/cache/data0/adaptor.esgf_wps.retrieve-1719480194.001044-934-14-04e4c2ff-456f-4c60-92e9-f0637edfd7c5.zip to ./cmip6_monthly_2015-2100_ssp245_inm_cm4_8.zip (50.2M)
2024-06-27 11:23:33,871 INFO Download rate 3.2M/s                               
2024-06-27 11:23:33,959 INFO Welcome to the CDS
2024-06-27 11:23:33,960 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:23:34,132 INFO Request is queued
2024-06-27 11:23:35,186 INFO Request is running
2024-06-27 11:23:42,472 INFO Request is completed
2024-06-27 11:23:42,473 INFO Downloading https://download-0010-clone.copernicus-climate.eu/cache-compute-0010/cache/data5/adaptor.esgf_wps.retrieve-1719480218.3890624-950-14-92434280-efe9-48f8-9578-82406b2e45ef.zip to ./cmip6_monthly_2015-2100_ssp245_ipsl_cm6a_lr.zip (47.4M)
2024-06-27 11:24:02,950 INFO Download rate 2.3M/s                               
2024-06-27 11:24:03,040 INFO Welcome to the CDS
2024-06-27 11:24:03,042 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:24:03,339 INFO Downloading https://download-0019.copernicus-climate.eu/cache-compute-0019/cache/data2/adaptor.esgf_wps.retrieve-1719306627.8710346-21615-12-ab1c7121-104e-422a-a44d-2c5c39e7eb03.zip to ./cmip6_monthly_2015-2100_ssp245_miroc_es2l.zip (18.7M)
2024-06-27 11:24:08,079 INFO Download rate 3.9M/s                               
2024-06-27 11:24:08,169 INFO Welcome to the CDS
2024-06-27 11:24:08,171 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:24:08,322 INFO Request is queued
2024-06-27 11:24:09,377 INFO Request is running
2024-06-27 11:24:21,778 INFO Request is completed
2024-06-27 11:24:21,779 INFO Downloading https://download-0008-clone.copernicus-climate.eu/cache-compute-0008/cache/data4/adaptor.esgf_wps.retrieve-1719480255.8133016-10407-7-89d7e819-d75b-4cf7-9e80-d0ac39198eb4.zip to ./cmip6_monthly_2015-2100_ssp245_mpi_esm1_2_lr.zip (33.2M)
2024-06-27 11:24:32,167 INFO Download rate 3.2M/s                               
2024-06-27 11:24:32,258 INFO Welcome to the CDS
2024-06-27 11:24:32,259 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:24:32,497 INFO Downloading https://download-0007-clone.copernicus-climate.eu/cache-compute-0007/cache/data7/adaptor.esgf_wps.retrieve-1712440865.8887649-1228-19-8b22f2ed-085d-472a-afe5-07506c652afc.zip to ./cmip6_monthly_2015-2100_ssp245_ukesm1_0_ll.zip (118.6M)
2024-06-27 11:24:49,243 INFO Download rate 7.1M/s                               
2024-06-27 11:24:49,333 INFO Welcome to the CDS
2024-06-27 11:24:49,334 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:24:49,625 INFO Request is queued
2024-06-27 11:24:50,687 INFO Request is running
2024-06-27 11:24:57,969 INFO Request is completed
2024-06-27 11:24:57,970 INFO Downloading https://download-0019.copernicus-climate.eu/cache-compute-0019/cache/data5/adaptor.esgf_wps.retrieve-1719480293.847178-23650-18-f3d1a138-f289-4aa2-92e8-e9888a77db40.zip to ./cmip6_monthly_2015-2100_ssp585_hadgem3_gc31_ll.zip (55.3M)
2024-06-27 11:25:09,305 INFO Download rate 4.9M/s                               
2024-06-27 11:25:09,393 INFO Welcome to the CDS
2024-06-27 11:25:09,395 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:25:09,569 INFO Request is queued
2024-06-27 11:25:10,623 INFO Request is running
2024-06-27 11:25:23,225 INFO Request is completed
2024-06-27 11:25:23,227 INFO Downloading https://download-0004-clone.copernicus-climate.eu/cache-compute-0004/cache/data1/adaptor.esgf_wps.retrieve-1719480313.9066012-15198-14-0f8ab97f-e158-4adc-afa1-408e7d146cd0.zip to ./cmip6_monthly_2015-2100_ssp585_inm_cm5_0.zip (66M)
2024-06-27 11:25:49,401 INFO Download rate 2.5M/s                               
2024-06-27 11:25:49,501 INFO Welcome to the CDS
2024-06-27 11:25:49,503 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:25:49,757 INFO Request is queued
2024-06-27 11:25:50,817 INFO Request is running
2024-06-27 11:25:58,120 INFO Request is completed
2024-06-27 11:25:58,121 INFO Downloading https://download-0016.copernicus-climate.eu/cache-compute-0016/cache/data4/adaptor.esgf_wps.retrieve-1719480354.3229218-11663-16-9c40b37a-4ad0-4c83-b846-a9beee6fa3f7.zip to ./cmip6_monthly_2015-2100_ssp585_inm_cm4_8.zip (50.1M)
2024-06-27 11:26:13,406 INFO Download rate 3.3M/s                               
2024-06-27 11:26:13,507 INFO Welcome to the CDS
2024-06-27 11:26:13,509 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:26:13,655 INFO Request is queued
2024-06-27 11:26:14,717 INFO Request is running
2024-06-27 11:26:22,015 INFO Request is completed
2024-06-27 11:26:22,017 INFO Downloading https://download-0010-clone.copernicus-climate.eu/cache-compute-0010/cache/data1/adaptor.esgf_wps.retrieve-1719480378.0158186-29754-19-cd1268ac-4cd2-4e9f-861f-1c89e730b4ea.zip to ./cmip6_monthly_2015-2100_ssp585_ipsl_cm6a_lr.zip (47.3M)
2024-06-27 11:26:29,564 INFO Download rate 6.3M/s                               
2024-06-27 11:26:29,670 INFO Welcome to the CDS
2024-06-27 11:26:29,672 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:26:29,813 INFO Request is queued
2024-06-27 11:26:30,872 INFO Request is running
2024-06-27 11:26:38,168 INFO Request is completed
2024-06-27 11:26:38,170 INFO Downloading https://download-0006-clone.copernicus-climate.eu/cache-compute-0006/cache/data5/adaptor.esgf_wps.retrieve-1719480394.2181084-22109-17-773545b5-31b8-4b5d-a881-a28edfb8df73.zip to ./cmip6_monthly_2015-2100_ssp585_miroc_es2l.zip (18.6M)
2024-06-27 11:26:42,665 INFO Download rate 4.1M/s                               
2024-06-27 11:26:42,763 INFO Welcome to the CDS
2024-06-27 11:26:42,764 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:26:42,956 INFO Downloading https://download-0004-clone.copernicus-climate.eu/cache-compute-0004/cache/data9/adaptor.esgf_wps.retrieve-1719306784.6103451-7619-18-1215824f-d2ed-47f9-94b0-0226eac0ab10.zip to ./cmip6_monthly_2015-2100_ssp585_mpi_esm1_2_lr.zip (33.1M)
2024-06-27 11:26:55,019 INFO Download rate 2.7M/s                               
2024-06-27 11:26:55,123 INFO Welcome to the CDS
2024-06-27 11:26:55,124 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/projections-cmip6
2024-06-27 11:26:55,316 INFO Request is queued
2024-06-27 11:26:56,375 INFO Request is running
2024-06-27 11:27:08,796 INFO Request is completed
2024-06-27 11:27:08,798 INFO Downloading https://download-0006-clone.copernicus-climate.eu/cache-compute-0006/cache/data8/adaptor.esgf_wps.retrieve-1719480422.6486294-22107-12-4044be8c-bea5-4384-96d7-4bd5d1bad641.zip to ./cmip6_monthly_2015-2100_ssp585_ukesm1_0_ll.zip (63.3M)
2024-06-27 11:27:23,571 INFO Download rate 4.3M/s                               
</pre></div>
</div>
</div>
</div>
<hr></section>
<section id="unzip-the-downloaded-data-files">
<h2>3. Unzip the downloaded data files<a class="headerlink" href="#unzip-the-downloaded-data-files" title="Link to this heading">#</a></h2>
<p>From the CDS, CMIP6 data are available as <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code> files compressed into <code class="docutils literal notranslate"><span class="pre">zip</span></code> archives. For this reason, before we can load any data, we have to extract the files. Having downloaded the four experiments <code class="docutils literal notranslate"><span class="pre">historical</span></code>, <code class="docutils literal notranslate"><span class="pre">SSP1-2.6</span></code>, <code class="docutils literal notranslate"><span class="pre">SSP2-4.5</span></code> and <code class="docutils literal notranslate"><span class="pre">SSP5-8.5</span></code> as seperate zip files, we can use the functions from the <code class="docutils literal notranslate"><span class="pre">zipfile</span></code> Python package to extract their contents. For each zip file we first construct a <code class="docutils literal notranslate"><span class="pre">ZipFile()</span></code> object, then we apply the function <code class="docutils literal notranslate"><span class="pre">extractall()</span></code> to extract its content.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip6_zip_paths</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">*.zip&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">cmip6_zip_paths</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
        <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="create-a-list-of-the-extracted-files">
<h3>Create a list of the extracted files<a class="headerlink" href="#create-a-list-of-the-extracted-files" title="Link to this heading">#</a></h3>
<p>To facilitate batch processing later in the tutorial, here we create a list of the extracted NetCDF files:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip6_nc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">cmip6_nc_rel</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">tas*.nc&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cmip6_nc_rel</span><span class="p">:</span>
    <span class="n">cmip6_nc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We will briefly inspect this list by printing the first five elements, corresponding to the filenames of a sample of the extracted NetCDF files:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip6_nc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;tas_Amon_UKESM1-0-LL_ssp585_r1i1p1f2_gn_205001-210012_v20190507.nc&#39;,
 &#39;tas_Amon_MPI-ESM1-2-LR_ssp126_r1i1p1f1_gn_205501-207412_v20190710.nc&#39;,
 &#39;tas_Amon_UKESM1-0-LL_historical_r13i1p1f2_gn_185001-194912_v20190406.nc&#39;,
 &#39;tas_Amon_MPI-ESM1-2-LR_ssp245_r1i1p1f1_gn_207501-209412_v20190710.nc&#39;,
 &#39;tas_Amon_UKESM1-0-LL_ssp585_r1i1p1f2_gn_201501-204912_v20190507.nc&#39;]
</pre></div>
</div>
</div>
</div>
<hr></section>
</section>
<section id="load-and-prepare-cmip6-data-for-one-model-and-one-experiment">
<h2>4. Load and prepare CMIP6 data for one model and one experiment<a class="headerlink" href="#load-and-prepare-cmip6-data-for-one-model-and-one-experiment" title="Link to this heading">#</a></h2>
<p>Now that we have downloaded and extracted the data, we can prepare it in order to view a time series of the spread of annual global temperature for the model ensemble. These preparation steps include the following:</p>
<ol class="arabic simple">
<li><p><strong>Spatial aggregation</strong>: to have a single global temperature value for each model/experiment dataset, and for each time step</p></li>
<li><p><strong>Temporal aggregation</strong>: from monthly to yearly</p></li>
<li><p><strong>Conversion from Kelvin to Celsius</strong></p></li>
<li><p><strong>Creation of additional data dimensions</strong> in preparation for the merging of datasets from different models and experiments</p></li>
</ol>
<p>In this section we apply these steps to a single dataset from one model and one experiment. In the next section we merge data from all models/experiments in preparation for the final processing and plotting of the temperature time series.</p>
<hr><section id="a-load-and-inspect-data">
<h3>4.A. Load and inspect data<a class="headerlink" href="#a-load-and-inspect-data" title="Link to this heading">#</a></h3>
<p>We begin by loading the first of the NetCDF files in our list. We will use the Python library <a class="reference external" href="http://xarray.pydata.org/en/stable/">xarray</a> and its function <code class="docutils literal notranslate"><span class="pre">open_dataset</span></code> to read NetCDF files.</p>
<p>The result is a <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> object with four dimensions: <code class="docutils literal notranslate"><span class="pre">bnds</span></code>, <code class="docutils literal notranslate"><span class="pre">lat</span></code>, <code class="docutils literal notranslate"><span class="pre">lon</span></code>, <code class="docutils literal notranslate"><span class="pre">time</span></code>, of which the dimension <code class="docutils literal notranslate"><span class="pre">bnds</span></code> is not callable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}{</span><span class="n">cmip6_nc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '‚ñ∫';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '‚ñº';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 68MB
Dimensions:    (time: 612, bnds: 2, lat: 144, lon: 192)
Coordinates:
  * time       (time) object 5kB 2050-01-16 00:00:00 ... 2100-12-16 00:00:00
  * lat        (lat) float64 1kB -89.38 -88.12 -86.88 ... 86.88 88.12 89.38
  * lon        (lon) float64 2kB 0.9375 2.812 4.688 6.562 ... 355.3 357.2 359.1
    height     float64 8B ...
Dimensions without coordinates: bnds
Data variables:
    time_bnds  (time, bnds) object 10kB ...
    lat_bnds   (lat, bnds) float64 2kB ...
    lon_bnds   (lon, bnds) float64 3kB ...
    tas        (time, lat, lon) float32 68MB ...
Attributes: (12/46)
    Conventions:            CF-1.7 CMIP-6.2
    activity_id:            ScenarioMIP
    branch_method:          standard
    branch_time_in_child:   59400.0
    branch_time_in_parent:  59400.0
    creation_date:          2019-04-18T14:30:46Z
    ...                     ...
    title:                  UKESM1-0-LL output prepared for CMIP6
    variable_id:            tas
    variant_label:          r1i1p1f2
    license:                CMIP6 model data produced by the Met Office Hadle...
    cmor_version:           3.4.0
    tracking_id:            hdl:21.14100/542545ca-f8aa-49bf-abf5-b6b0e97dbaec</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e27ccd17-f89c-447b-9326-85e67778170b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e27ccd17-f89c-447b-9326-85e67778170b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 612</li><li><span>bnds</span>: 2</li><li><span class='xr-has-index'>lat</span>: 144</li><li><span class='xr-has-index'>lon</span>: 192</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4e20269d-3516-48f3-8998-0728927d9473' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4e20269d-3516-48f3-8998-0728927d9473' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>2050-01-16 00:00:00 ... 2100-12-...</div><input id='attrs-890bc621-fc06-4fa1-ac3b-e7e55bba42a0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-890bc621-fc06-4fa1-ac3b-e7e55bba42a0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-35518ddf-523c-43e0-9c99-e09b50c4bcd1' class='xr-var-data-in' type='checkbox'><label for='data-35518ddf-523c-43e0-9c99-e09b50c4bcd1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([cftime.Datetime360Day(2050, 1, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.Datetime360Day(2050, 2, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.Datetime360Day(2050, 3, 16, 0, 0, 0, 0, has_year_zero=True), ...,
       cftime.Datetime360Day(2100, 10, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.Datetime360Day(2100, 11, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.Datetime360Day(2100, 12, 16, 0, 0, 0, 0, has_year_zero=True)],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-89.38 -88.12 ... 88.12 89.38</div><input id='attrs-0764bfe1-521a-41b3-b4ca-3c9afec83239' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0764bfe1-521a-41b3-b4ca-3c9afec83239' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1503fab-8db5-4b27-bfee-7074e0603152' class='xr-var-data-in' type='checkbox'><label for='data-d1503fab-8db5-4b27-bfee-7074e0603152' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>lat_bnds</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([-89.375, -88.125, -86.875, -85.625, -84.375, -83.125, -81.875, -80.625,
       -79.375, -78.125, -76.875, -75.625, -74.375, -73.125, -71.875, -70.625,
       -69.375, -68.125, -66.875, -65.625, -64.375, -63.125, -61.875, -60.625,
       -59.375, -58.125, -56.875, -55.625, -54.375, -53.125, -51.875, -50.625,
       -49.375, -48.125, -46.875, -45.625, -44.375, -43.125, -41.875, -40.625,
       -39.375, -38.125, -36.875, -35.625, -34.375, -33.125, -31.875, -30.625,
       -29.375, -28.125, -26.875, -25.625, -24.375, -23.125, -21.875, -20.625,
       -19.375, -18.125, -16.875, -15.625, -14.375, -13.125, -11.875, -10.625,
        -9.375,  -8.125,  -6.875,  -5.625,  -4.375,  -3.125,  -1.875,  -0.625,
         0.625,   1.875,   3.125,   4.375,   5.625,   6.875,   8.125,   9.375,
        10.625,  11.875,  13.125,  14.375,  15.625,  16.875,  18.125,  19.375,
        20.625,  21.875,  23.125,  24.375,  25.625,  26.875,  28.125,  29.375,
        30.625,  31.875,  33.125,  34.375,  35.625,  36.875,  38.125,  39.375,
        40.625,  41.875,  43.125,  44.375,  45.625,  46.875,  48.125,  49.375,
        50.625,  51.875,  53.125,  54.375,  55.625,  56.875,  58.125,  59.375,
        60.625,  61.875,  63.125,  64.375,  65.625,  66.875,  68.125,  69.375,
        70.625,  71.875,  73.125,  74.375,  75.625,  76.875,  78.125,  79.375,
        80.625,  81.875,  83.125,  84.375,  85.625,  86.875,  88.125,  89.375])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.9375 2.812 4.688 ... 357.2 359.1</div><input id='attrs-30f91584-cb2d-47a4-a8c1-2f526ccd542f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-30f91584-cb2d-47a4-a8c1-2f526ccd542f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fd5f8d42-7b4a-458c-8c46-075d2951b143' class='xr-var-data-in' type='checkbox'><label for='data-fd5f8d42-7b4a-458c-8c46-075d2951b143' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>lon_bnds</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([  0.9375,   2.8125,   4.6875,   6.5625,   8.4375,  10.3125,  12.1875,
        14.0625,  15.9375,  17.8125,  19.6875,  21.5625,  23.4375,  25.3125,
        27.1875,  29.0625,  30.9375,  32.8125,  34.6875,  36.5625,  38.4375,
        40.3125,  42.1875,  44.0625,  45.9375,  47.8125,  49.6875,  51.5625,
        53.4375,  55.3125,  57.1875,  59.0625,  60.9375,  62.8125,  64.6875,
        66.5625,  68.4375,  70.3125,  72.1875,  74.0625,  75.9375,  77.8125,
        79.6875,  81.5625,  83.4375,  85.3125,  87.1875,  89.0625,  90.9375,
        92.8125,  94.6875,  96.5625,  98.4375, 100.3125, 102.1875, 104.0625,
       105.9375, 107.8125, 109.6875, 111.5625, 113.4375, 115.3125, 117.1875,
       119.0625, 120.9375, 122.8125, 124.6875, 126.5625, 128.4375, 130.3125,
       132.1875, 134.0625, 135.9375, 137.8125, 139.6875, 141.5625, 143.4375,
       145.3125, 147.1875, 149.0625, 150.9375, 152.8125, 154.6875, 156.5625,
       158.4375, 160.3125, 162.1875, 164.0625, 165.9375, 167.8125, 169.6875,
       171.5625, 173.4375, 175.3125, 177.1875, 179.0625, 180.9375, 182.8125,
       184.6875, 186.5625, 188.4375, 190.3125, 192.1875, 194.0625, 195.9375,
       197.8125, 199.6875, 201.5625, 203.4375, 205.3125, 207.1875, 209.0625,
       210.9375, 212.8125, 214.6875, 216.5625, 218.4375, 220.3125, 222.1875,
       224.0625, 225.9375, 227.8125, 229.6875, 231.5625, 233.4375, 235.3125,
       237.1875, 239.0625, 240.9375, 242.8125, 244.6875, 246.5625, 248.4375,
       250.3125, 252.1875, 254.0625, 255.9375, 257.8125, 259.6875, 261.5625,
       263.4375, 265.3125, 267.1875, 269.0625, 270.9375, 272.8125, 274.6875,
       276.5625, 278.4375, 280.3125, 282.1875, 284.0625, 285.9375, 287.8125,
       289.6875, 291.5625, 293.4375, 295.3125, 297.1875, 299.0625, 300.9375,
       302.8125, 304.6875, 306.5625, 308.4375, 310.3125, 312.1875, 314.0625,
       315.9375, 317.8125, 319.6875, 321.5625, 323.4375, 325.3125, 327.1875,
       329.0625, 330.9375, 332.8125, 334.6875, 336.5625, 338.4375, 340.3125,
       342.1875, 344.0625, 345.9375, 347.8125, 349.6875, 351.5625, 353.4375,
       355.3125, 357.1875, 359.0625])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4f6ba75a-938a-4211-8acc-6c6f545ccc45' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4f6ba75a-938a-4211-8acc-6c6f545ccc45' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-055aefe4-7aad-457d-a7ee-6111aadc100f' class='xr-var-data-in' type='checkbox'><label for='data-055aefe4-7aad-457d-a7ee-6111aadc100f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>long_name :</span></dt><dd>height</dd><dt><span>standard_name :</span></dt><dd>height</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-14fb26aa-79c9-43bf-b862-88aa364d5fc0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-14fb26aa-79c9-43bf-b862-88aa364d5fc0' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time, bnds)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d0e31b83-beaf-4aa7-b3c8-60084c011cc3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d0e31b83-beaf-4aa7-b3c8-60084c011cc3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-635de2b7-eedd-4d7b-830e-e48930cb6089' class='xr-var-data-in' type='checkbox'><label for='data-635de2b7-eedd-4d7b-830e-e48930cb6089' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1224 values with dtype=object]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat_bnds</span></div><div class='xr-var-dims'>(lat, bnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-7a6630ae-530c-4f9f-8081-5be05ccdad60' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7a6630ae-530c-4f9f-8081-5be05ccdad60' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0c42f065-b13c-4052-bf6c-bf5f0c8b6a16' class='xr-var-data-in' type='checkbox'><label for='data-0c42f065-b13c-4052-bf6c-bf5f0c8b6a16' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[288 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon_bnds</span></div><div class='xr-var-dims'>(lon, bnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-9233405c-e0a6-43e5-b690-261518ebb425' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9233405c-e0a6-43e5-b690-261518ebb425' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9228e4d8-0a37-4ce9-ab71-2c2949ee69ef' class='xr-var-data-in' type='checkbox'><label for='data-9228e4d8-0a37-4ce9-ab71-2c2949ee69ef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[384 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-43c7360c-e9b2-4528-abda-5b4f6bc85011' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-43c7360c-e9b2-4528-abda-5b4f6bc85011' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-380a66ab-4517-459a-9925-cc8ff4db5372' class='xr-var-data-in' type='checkbox'><label for='data-380a66ab-4517-459a-9925-cc8ff4db5372' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>long_name :</span></dt><dd>Near-Surface Air Temperature</dd><dt><span>comment :</span></dt><dd>near-surface (usually, 2 meter) air temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>original_name :</span></dt><dd>mo: (stash: m01s03i236, lbproc: 128)</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd><dt><span>history :</span></dt><dd>2019-04-18T14:30:46Z altered by CMOR: Treated scalar dimension: &#x27;height&#x27;. 2019-04-18T14:30:46Z altered by CMOR: replaced missing value flag (-1.07374e+09) with standard missing value (1e+20).</dd></dl></div><div class='xr-var-data'><pre>[16920576 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-587fe399-90b7-49cf-8355-f2ff79648818' class='xr-section-summary-in' type='checkbox'  ><label for='section-587fe399-90b7-49cf-8355-f2ff79648818' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bb575b19-8291-4b1e-bfd8-59afe25ff2c2' class='xr-index-data-in' type='checkbox'/><label for='index-bb575b19-8291-4b1e-bfd8-59afe25ff2c2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(CFTimeIndex([2050-01-16 00:00:00, 2050-02-16 00:00:00, 2050-03-16 00:00:00,
             2050-04-16 00:00:00, 2050-05-16 00:00:00, 2050-06-16 00:00:00,
             2050-07-16 00:00:00, 2050-08-16 00:00:00, 2050-09-16 00:00:00,
             2050-10-16 00:00:00,
             ...
             2100-03-16 00:00:00, 2100-04-16 00:00:00, 2100-05-16 00:00:00,
             2100-06-16 00:00:00, 2100-07-16 00:00:00, 2100-08-16 00:00:00,
             2100-09-16 00:00:00, 2100-10-16 00:00:00, 2100-11-16 00:00:00,
             2100-12-16 00:00:00],
            dtype=&#x27;object&#x27;, length=612, calendar=&#x27;360_day&#x27;, freq=&#x27;30D&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1ee206cf-bfda-45fd-9d2d-d33fc5143b0f' class='xr-index-data-in' type='checkbox'/><label for='index-1ee206cf-bfda-45fd-9d2d-d33fc5143b0f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.375, -88.125, -86.875, -85.625, -84.375, -83.125, -81.875, -80.625,
       -79.375, -78.125,
       ...
        78.125,  79.375,  80.625,  81.875,  83.125,  84.375,  85.625,  86.875,
        88.125,  89.375],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=144))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-65218b8a-89bf-430f-bd7c-4606591ed53e' class='xr-index-data-in' type='checkbox'/><label for='index-65218b8a-89bf-430f-bd7c-4606591ed53e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0.9375,   2.8125,   4.6875,   6.5625,   8.4375,  10.3125,  12.1875,
        14.0625,  15.9375,  17.8125,
       ...
       342.1875, 344.0625, 345.9375, 347.8125, 349.6875, 351.5625, 353.4375,
       355.3125, 357.1875, 359.0625],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=192))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d4a59b84-4fb4-4daf-b339-639169a43169' class='xr-section-summary-in' type='checkbox'  ><label for='section-d4a59b84-4fb4-4daf-b339-639169a43169' class='xr-section-summary' >Attributes: <span>(46)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.7 CMIP-6.2</dd><dt><span>activity_id :</span></dt><dd>ScenarioMIP</dd><dt><span>branch_method :</span></dt><dd>standard</dd><dt><span>branch_time_in_child :</span></dt><dd>59400.0</dd><dt><span>branch_time_in_parent :</span></dt><dd>59400.0</dd><dt><span>creation_date :</span></dt><dd>2019-04-18T14:30:46Z</dd><dt><span>cv_version :</span></dt><dd>6.2.20.1</dd><dt><span>data_specs_version :</span></dt><dd>01.00.29</dd><dt><span>experiment :</span></dt><dd>update of RCP8.5 based on SSP5</dd><dt><span>experiment_id :</span></dt><dd>ssp585</dd><dt><span>external_variables :</span></dt><dd>areacella</dd><dt><span>forcing_index :</span></dt><dd>2</dd><dt><span>frequency :</span></dt><dd>mon</dd><dt><span>further_info_url :</span></dt><dd>https://furtherinfo.es-doc.org/CMIP6.MOHC.UKESM1-0-LL.ssp585.none.r1i1p1f2</dd><dt><span>grid :</span></dt><dd>Native N96 grid; 192 x 144 longitude/latitude</dd><dt><span>grid_label :</span></dt><dd>gn</dd><dt><span>history :</span></dt><dd>2019-04-18T14:18:43Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.;
2019-04-18T14:17:53Z MIP Convert v1.0.3, Python v2.7.12, Iris v1.13.0, Numpy v1.13.3, netcdftime v1.4.1.</dd><dt><span>initialization_index :</span></dt><dd>1</dd><dt><span>institution :</span></dt><dd>Met Office Hadley Centre, Fitzroy Road, Exeter, Devon, EX1 3PB, UK</dd><dt><span>institution_id :</span></dt><dd>MOHC</dd><dt><span>mip_era :</span></dt><dd>CMIP6</dd><dt><span>mo_runid :</span></dt><dd>u-be653</dd><dt><span>nominal_resolution :</span></dt><dd>250 km</dd><dt><span>parent_activity_id :</span></dt><dd>CMIP</dd><dt><span>parent_experiment_id :</span></dt><dd>historical</dd><dt><span>parent_mip_era :</span></dt><dd>CMIP6</dd><dt><span>parent_source_id :</span></dt><dd>UKESM1-0-LL</dd><dt><span>parent_time_units :</span></dt><dd>days since 1850-01-01-00-00-00</dd><dt><span>parent_variant_label :</span></dt><dd>r1i1p1f2</dd><dt><span>physics_index :</span></dt><dd>1</dd><dt><span>product :</span></dt><dd>model-output</dd><dt><span>realization_index :</span></dt><dd>1</dd><dt><span>realm :</span></dt><dd>atmos</dd><dt><span>source :</span></dt><dd>UKESM1.0-LL (2018): 
aerosol: UKCA-GLOMAP-mode
atmos: MetUM-HadGEM3-GA7.1 (N96; 192 x 144 longitude/latitude; 85 levels; top level 85 km)
atmosChem: UKCA-StratTrop
land: JULES-ES-1.0
landIce: none
ocean: NEMO-HadGEM3-GO6.0 (eORCA1 tripolar primarily 1 deg with meridional refinement down to 1/3 degree in the tropics; 360 x 330 longitude/latitude; 75 levels; top grid cell 0-1 m)
ocnBgchem: MEDUSA2
seaIce: CICE-HadGEM3-GSI8 (eORCA1 tripolar primarily 1 deg; 360 x 330 longitude/latitude)</dd><dt><span>source_id :</span></dt><dd>UKESM1-0-LL</dd><dt><span>source_type :</span></dt><dd>AOGCM AER BGC CHEM</dd><dt><span>sub_experiment :</span></dt><dd>none</dd><dt><span>sub_experiment_id :</span></dt><dd>none</dd><dt><span>table_id :</span></dt><dd>Amon</dd><dt><span>table_info :</span></dt><dd>Creation Date:(13 December 2018) MD5:2b12b5db6db112aa8b8b0d6c1645b121</dd><dt><span>title :</span></dt><dd>UKESM1-0-LL output prepared for CMIP6</dd><dt><span>variable_id :</span></dt><dd>tas</dd><dt><span>variant_label :</span></dt><dd>r1i1p1f2</dd><dt><span>license :</span></dt><dd>CMIP6 model data produced by the Met Office Hadley Centre is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License (https://creativecommons.org/licenses). Consult https://pcmdi.llnl.gov/CMIP6/TermsOfUse for terms of use governing CMIP6 output, including citation requirements and proper acknowledgment. Further information about this data, including some limitations, can be found via the further_info_url (recorded as a global attribute in this file) and at https://ukesm.ac.uk/cmip6. The data producers and data providers make no warranty, either express or implied, including, but not limited to, warranties of merchantability and fitness for a particular purpose. All liabilities arising from the supply of the information (including any liability arising in negligence) are excluded to the fullest extent permitted by law.</dd><dt><span>cmor_version :</span></dt><dd>3.4.0</dd><dt><span>tracking_id :</span></dt><dd>hdl:21.14100/542545ca-f8aa-49bf-abf5-b6b0e97dbaec</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>By examining the data above, we can see from the temporal range (1850 to 2014) that it is from the <code class="docutils literal notranslate"><span class="pre">historical</span></code> experiment.</p>
<p>We see that the data dimensions have been given labelled coordinates of time, latitude and longitude. We can find more about the dataset from the <code class="docutils literal notranslate"><span class="pre">Attributes</span></code>, such information includes the model name, description of the variable (<code class="docutils literal notranslate"><span class="pre">long_name</span></code>), units, etc.</p>
<p>Some of this information we will need later, this includes the experiment and model IDs. We will save these into variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exp</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;experiment_id&#39;</span><span class="p">]</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;source_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>An <code class="docutils literal notranslate"><span class="pre">xarray.Dataset()</span></code> may contain arrays of multiple variables. We only have one variable in the dataset, which is near-surface air temperature, <code class="docutils literal notranslate"><span class="pre">tas</span></code>. Below we create an <code class="docutils literal notranslate"><span class="pre">xarray.DataArray()</span></code> object, which takes only one variable, but gives us more flexibility in processing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<hr></section>
<section id="b-spatial-aggregation">
<h3>4.B. Spatial aggregation<a class="headerlink" href="#b-spatial-aggregation" title="Link to this heading">#</a></h3>
<p>The next step is to aggregate the temperature values spatially (i.e. average over the latitude and longitude dimensions) and compute the global monthly near-surface temperature.</p>
<p>A very important consideration however is that the gridded data cells do not all correspond to the same areas. The size covered by each data point varies as a function of latitude. We need to take this into account when averaging. One way to do this is to use the cosine of the latitude as a proxy for the varying sizes.</p>
<p>This can be implemented by first calculating weights as a function of the cosine of the latitude, then applying these weights to the data array with the xarray function <code class="docutils literal notranslate"><span class="pre">weighted()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
<span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
<span class="n">da_weighted</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The next step is then to compute the mean across the latitude and longitude dimensions of the weighted data array with the function <code class="docutils literal notranslate"><span class="pre">mean()</span></code>. The result is a DataArray with one dimension (<code class="docutils literal notranslate"><span class="pre">time</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_agg</span> <span class="o">=</span> <span class="n">da_weighted</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<hr></section>
<section id="c-temporal-aggregation">
<h3>4.C. Temporal aggregation<a class="headerlink" href="#c-temporal-aggregation" title="Link to this heading">#</a></h3>
<p>We now aggregate the monthly global near-surface air temperature values to annual global near-surface air temperature values. This operation can be done in two steps: first, all the values for one specific year have to be grouped with the function <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> and second, we can create the average of each group with the function <code class="docutils literal notranslate"><span class="pre">mean()</span></code>.</p>
<p>The result is a one-dimensional DataArray. Please note that this operation changes the name of the dimension from <code class="docutils literal notranslate"><span class="pre">time</span></code> to <code class="docutils literal notranslate"><span class="pre">year</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_agg</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<hr></section>
<section id="d-conversion-from-kelvin-to-celsius">
<h3>4.D. Conversion from Kelvin to Celsius<a class="headerlink" href="#d-conversion-from-kelvin-to-celsius" title="Link to this heading">#</a></h3>
<p>The metadata of the original data (before it was stripped during the subsequent processing steps) tells us that the near-surface air temperature data values are in units of Kelvin. We will convert them to degrees Celsius by subtracting 273.15 from the data values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span> <span class="o">-</span> <span class="mf">273.15</span>
</pre></div>
</div>
</div>
</div>
<hr></section>
<section id="e-create-additional-data-dimensions">
<h3>4.E. Create additional data dimensions<a class="headerlink" href="#e-create-additional-data-dimensions" title="Link to this heading">#</a></h3>
<p>Finally, we will create additional dimensions for the model and for the experiment. These we will label with the model and experiment name as taken from the metadata of the original data (see above). These will be useful when we repeat the processes above for all models and experiments, and combine them into one array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">mod</span><span class="p">)</span>
<span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
<span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">exp</span><span class="p">)</span>
<span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="s1">&#39;experiment&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr></section>
</section>
<section id="load-and-prepare-cmip6-data-for-all-models-and-experiments">
<h2>5. Load and prepare CMIP6 data for all models and experiments<a class="headerlink" href="#load-and-prepare-cmip6-data-for-all-models-and-experiments" title="Link to this heading">#</a></h2>
<p>To repeat the steps above for all models and all experiments, we will collect all of the commands we have used so far into a function, which we can then apply to a batch of files corresponding to the data from all models and experiments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to aggregate in geographical lat lon dimensions</span>

<span class="k">def</span> <span class="nf">geog_agg</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}{</span><span class="n">fn</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">exp</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;experiment_id&#39;</span><span class="p">]</span>
    <span class="n">mod</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;source_id&#39;</span><span class="p">]</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
    <span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
    <span class="n">da_weighted</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">da_agg</span> <span class="o">=</span> <span class="n">da_weighted</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
    <span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_agg</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span> <span class="o">-</span> <span class="mf">273.15</span>
    <span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">mod</span><span class="p">)</span>
    <span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
    <span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">exp</span><span class="p">)</span>
    <span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="s1">&#39;experiment&#39;</span><span class="p">)</span>
    <span class="n">da_yr</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">cmip6_agg_</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">mod</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">da_yr</span><span class="o">.</span><span class="n">year</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s1">.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can apply this function to all the extracted NetCDF files. The <code class="docutils literal notranslate"><span class="pre">try</span></code> and <code class="docutils literal notranslate"><span class="pre">except</span></code> clauses ensure that all NetCDF files are attempted, even if some fail to be processed. One reason why some may fail is if the data are labelled differently, e.g. the model <em>MCM-UA-1-0</em> has coordinates labelled as ‚Äú<em>latitude</em>‚Äù and <em>longitude</em>‚Äù. This differs from the suggested standard, and more commonly applied labels of ‚Äú<em>lat</em>‚Äù and ‚Äú<em>lon</em>‚Äù. Any that fail will be recorded in a print statement, and these can be processed separately. See <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/CMIP6%3A+Global+climate+projections#CMIP6:Globalclimateprojections-QualitycontroloftheCDS-CMIP6subset">here</a> more details on the quality control of the CMIP6 datasets on the CDS.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cmip6_nc</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">geog_agg</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> failed&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the absence of any print statements, we see that all files were successfully processed.</p>
<p>We will now combine these processed files into one dataset for the final steps to create a visualisation of near-surface air temperature from the model ensemble.</p>
<p>If all files have the same coordinates, the function <code class="docutils literal notranslate"><span class="pre">xarray.open_mfdataset</span></code> will merge the data according to the same coordinates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">cmip6_agg*.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The dataset created by <code class="docutils literal notranslate"><span class="pre">xarray.open_mfdataset</span></code> is by default in the form of <code class="docutils literal notranslate"><span class="pre">lazy</span> <span class="pre">Dask</span> <span class="pre">arrays</span></code>.</p>
<p>Dask divides arrays into many small pieces, called chunks, each of which is presumed to be small enough to fit into memory. As opposed to eager evaluation, operations on Dask arrays are lazy, i.e. operations queue up a series of tasks mapped over blocks, and no computation is performed until you request values to be computed. See <a class="reference external" href="https://xarray.pydata.org/en/stable/user-guide/dask.html">this page</a> for more details.</p>
<p>To facilitate further processing we would need to convert these Dask arrays into in-memory ‚Äúeager‚Äù arrays, which we can do by using the <code class="docutils literal notranslate"><span class="pre">load()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_ds</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '‚ñ∫';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '‚ñº';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 59kB
Dimensions:     (experiment: 4, model: 7, year: 251)
Coordinates:
  * year        (year) int64 2kB 1850 1851 1852 1853 ... 2097 2098 2099 2100
  * model       (model) &lt;U15 420B &#x27;HadGEM3-GC31-LL&#x27; ... &#x27;UKESM1-0-LL&#x27;
  * experiment  (experiment) &lt;U10 160B &#x27;historical&#x27; &#x27;ssp126&#x27; &#x27;ssp245&#x27; &#x27;ssp585&#x27;
    height      (model) float64 56B 1.5 2.0 2.0 2.0 2.0 2.0 1.5
Data variables:
    tas         (experiment, model, year) float64 56kB 13.58 13.62 ... 20.63</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-16c45c55-5746-4103-92af-107ba6e9484c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-16c45c55-5746-4103-92af-107ba6e9484c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>experiment</span>: 4</li><li><span class='xr-has-index'>model</span>: 7</li><li><span class='xr-has-index'>year</span>: 251</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-eb57da9c-e6c2-4479-8a6d-9a20b763c913' class='xr-section-summary-in' type='checkbox'  checked><label for='section-eb57da9c-e6c2-4479-8a6d-9a20b763c913' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1850 1851 1852 ... 2098 2099 2100</div><input id='attrs-8ba25da9-9fa2-46e6-b68b-55017e0c7a94' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8ba25da9-9fa2-46e6-b68b-55017e0c7a94' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cb295bf8-8792-46e7-a05b-9de34865abc3' class='xr-var-data-in' type='checkbox'><label for='data-cb295bf8-8792-46e7-a05b-9de34865abc3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1850, 1851, 1852, ..., 2098, 2099, 2100])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>model</span></div><div class='xr-var-dims'>(model)</div><div class='xr-var-dtype'>&lt;U15</div><div class='xr-var-preview xr-preview'>&#x27;HadGEM3-GC31-LL&#x27; ... &#x27;UKESM1-0-LL&#x27;</div><input id='attrs-9b21ff10-681e-4873-886c-d42596ccacbb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9b21ff10-681e-4873-886c-d42596ccacbb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c3296089-376c-43f8-9220-d7a4dc635b91' class='xr-var-data-in' type='checkbox'><label for='data-c3296089-376c-43f8-9220-d7a4dc635b91' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;HadGEM3-GC31-LL&#x27;, &#x27;INM-CM4-8&#x27;, &#x27;INM-CM5-0&#x27;, &#x27;IPSL-CM6A-LR&#x27;,
       &#x27;MIROC-ES2L&#x27;, &#x27;MPI-ESM1-2-LR&#x27;, &#x27;UKESM1-0-LL&#x27;], dtype=&#x27;&lt;U15&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>experiment</span></div><div class='xr-var-dims'>(experiment)</div><div class='xr-var-dtype'>&lt;U10</div><div class='xr-var-preview xr-preview'>&#x27;historical&#x27; &#x27;ssp126&#x27; ... &#x27;ssp585&#x27;</div><input id='attrs-f4d66cf1-713c-46d7-a4be-1e739bdc0d2c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f4d66cf1-713c-46d7-a4be-1e739bdc0d2c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2af0dc1b-1ea9-4984-aba9-42acfbbe587f' class='xr-var-data-in' type='checkbox'><label for='data-2af0dc1b-1ea9-4984-aba9-42acfbbe587f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;historical&#x27;, &#x27;ssp126&#x27;, &#x27;ssp245&#x27;, &#x27;ssp585&#x27;], dtype=&#x27;&lt;U10&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height</span></div><div class='xr-var-dims'>(model)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.5 2.0 2.0 2.0 2.0 2.0 1.5</div><input id='attrs-81bece02-088a-43e8-8fc2-3213765da217' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-81bece02-088a-43e8-8fc2-3213765da217' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cdd9ef4c-2343-442c-959e-077d6b9d1a65' class='xr-var-data-in' type='checkbox'><label for='data-cdd9ef4c-2343-442c-959e-077d6b9d1a65' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1.5, 2. , 2. , 2. , 2. , 2. , 1.5])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7a8a543e-5788-428f-a6d9-8ca3d221d38b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7a8a543e-5788-428f-a6d9-8ca3d221d38b' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(experiment, model, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>13.58 13.62 13.7 ... 20.48 20.63</div><input id='attrs-76b6fb07-f127-494f-a880-df050f4bc6ea' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-76b6fb07-f127-494f-a880-df050f4bc6ea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6f36ac28-6a45-4e1d-83c0-3df49dafbca2' class='xr-var-data-in' type='checkbox'><label for='data-6f36ac28-6a45-4e1d-83c0-3df49dafbca2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[13.57671526, 13.61972281, 13.69983418, ...,         nan,
                 nan,         nan],
        [13.38971491, 13.36504047, 13.38635866, ...,         nan,
                 nan,         nan],
        [13.22804657, 13.19990532, 13.16567923, ...,         nan,
                 nan,         nan],
        ...,
        [14.94895045, 15.10892567, 15.03257159, ...,         nan,
                 nan,         nan],
        [13.47673094, 13.45913109, 13.46609431, ...,         nan,
                 nan,         nan],
        [13.32691155, 13.33535187, 13.43955638, ...,         nan,
                 nan,         nan]],

       [[        nan,         nan,         nan, ..., 16.29245683,
         16.36082827, 16.33036985],
        [        nan,         nan,         nan, ..., 14.76511278,
         14.71776501, 14.78597346],
        [        nan,         nan,         nan, ..., 14.57112824,
         14.57076709, 14.51991082],
...
        [        nan,         nan,         nan, ..., 17.47279885,
         17.79239638, 17.58084508],
        [        nan,         nan,         nan, ..., 16.0461109 ,
         16.01744213, 16.02138782],
        [        nan,         nan,         nan, ..., 17.85579411,
         17.80345584, 17.85325969]],

       [[        nan,         nan,         nan, ..., 20.39295861,
         20.52182487, 20.57955248],
        [        nan,         nan,         nan, ..., 17.39707069,
         17.3183903 , 17.38916422],
        [        nan,         nan,         nan, ..., 17.16603799,
         17.24878839, 17.27704339],
        ...,
        [        nan,         nan,         nan, ..., 19.3107107 ,
         19.39395087, 19.69432393],
        [        nan,         nan,         nan, ..., 18.06633781,
         17.98003727, 17.73531158],
        [        nan,         nan,         nan, ..., 20.65340704,
         20.48425935, 20.63318635]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e729fc05-d28c-406b-9323-b39ab4b9eb32' class='xr-section-summary-in' type='checkbox'  ><label for='section-e729fc05-d28c-406b-9323-b39ab4b9eb32' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-2ef393fc-d662-4eb8-9ae6-3ea6636f8382' class='xr-index-data-in' type='checkbox'/><label for='index-2ef393fc-d662-4eb8-9ae6-3ea6636f8382' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1850, 1851, 1852, 1853, 1854, 1855, 1856, 1857, 1858, 1859,
       ...
       2091, 2092, 2093, 2094, 2095, 2096, 2097, 2098, 2099, 2100],
      dtype=&#x27;int64&#x27;, name=&#x27;year&#x27;, length=251))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>model</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-03a03392-a93f-4e6a-a74c-b293525e529a' class='xr-index-data-in' type='checkbox'/><label for='index-03a03392-a93f-4e6a-a74c-b293525e529a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;HadGEM3-GC31-LL&#x27;, &#x27;INM-CM4-8&#x27;, &#x27;INM-CM5-0&#x27;, &#x27;IPSL-CM6A-LR&#x27;,
       &#x27;MIROC-ES2L&#x27;, &#x27;MPI-ESM1-2-LR&#x27;, &#x27;UKESM1-0-LL&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;model&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>experiment</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-09194624-4491-4ca3-904a-3fb80ba7f3a2' class='xr-index-data-in' type='checkbox'/><label for='index-09194624-4491-4ca3-904a-3fb80ba7f3a2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;historical&#x27;, &#x27;ssp126&#x27;, &#x27;ssp245&#x27;, &#x27;ssp585&#x27;], dtype=&#x27;object&#x27;, name=&#x27;experiment&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-79914635-4784-4c01-bbba-39914b4a898c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-79914635-4784-4c01-bbba-39914b4a898c' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Finally, we create an Xarray DataArray object for the near-surface air temperature variable, ‚Äòtas‚Äô:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data_ds</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<hr></section>
<section id="visualize-the-cmip6-annual-global-average-temperature-between-1850-to-2100">
<h2>6. Visualize the CMIP6 annual global average temperature between 1850 to 2100<a class="headerlink" href="#visualize-the-cmip6-annual-global-average-temperature-between-1850-to-2100" title="Link to this heading">#</a></h2>
<p>We will now create a plot of the model ensemble of near-surface air temperature for the historical and future periods, according to the three selected scenarios.</p>
<section id="a-calculate-quantiles-for-model-ensemble">
<h3>6.A. Calculate quantiles for model ensemble<a class="headerlink" href="#a-calculate-quantiles-for-model-ensemble" title="Link to this heading">#</a></h3>
<p>Rather than plotting the data from all models, we will instead view the range of values as given by quantiles, including the 10th (near to lower limit), the 50th (mid-range) and the 90th (near to upper limit) quantiles:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_90</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
<span class="n">data_10</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
<span class="n">data_50</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/numpy/lib/nanfunctions.py:1563: RuntimeWarning: All-NaN slice encountered
  return function_base._ureduce(a,
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-success">
<b>NOTE</b>: <br>
    The warning message is due to the presence of NaN (Not a Number) data given that the historical and scenario datasets represent only parts (historical and future respectively) of the entire time series. As these two datasets have been merged, NaN values will exist (e.g. there will be no data for the historical experiment for the future period).</div><hr></section>
<section id="b-view-time-series">
<h3>6.B. View time-series<a class="headerlink" href="#b-view-time-series" title="Link to this heading">#</a></h3>
<p>Finally we will visualise this data in one time-series plot. We will use the matplotlib function <code class="docutils literal notranslate"><span class="pre">plot()</span></code>. The dimension <code class="docutils literal notranslate"><span class="pre">year</span></code> will be the x-axis and the near-surface air temperature values in degrees Celsius will be the y-axis.</p>
<p>The plotting function below has four main parts:</p>
<ul class="simple">
<li><p><strong>Initiate the plot</strong>: initiate a matplotlib plot with <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code></p></li>
<li><p><strong>Plot the time-series</strong>: plot the data for each experiment, including the historical experiment and three scenarios with the <code class="docutils literal notranslate"><span class="pre">plot()</span></code> function</p></li>
<li><p><strong>Set axes limits, labels, title and legend</strong>: Define title and axes labels, and add additional items to the plot, such as legend or gridlines</p></li>
<li><p><strong>Save the figure</strong>: Save the figure as a PNG file with the <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.savefig()</span></code> function</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initiate the plot:</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1">#Plot the time-series:</span>
<span class="n">colours</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">experiments</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_50</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">data_50</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">colours</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> 
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data_50</span><span class="o">.</span><span class="n">experiment</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s1"> 50th quantile&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">data_50</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">data_90</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">data_10</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">colours</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> 
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data_50</span><span class="o">.</span><span class="n">experiment</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s1"> 10th and 90th quantile range&#39;</span><span class="p">)</span>

<span class="c1"># Set axes limits, labels, title and legend:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span><span class="mi">2100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;CMIP6 annual global average temperature (1850 to 2100)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;tam (Celsius)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1">#Save the figure:</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">CMIP6_annual_global_tas.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/79f9e9ef458a69882068dceb36e418f591951611a9e1619637640d847bfd3a76.png" src="../../_images/79f9e9ef458a69882068dceb36e418f591951611a9e1619637640d847bfd3a76.png" />
</div>
</div>
<p>The visualization of the <code class="docutils literal notranslate"><span class="pre">CMIP6</span> <span class="pre">annual</span> <span class="pre">global</span> <span class="pre">average</span> <span class="pre">temperature</span> <span class="pre">(1850</span> <span class="pre">to</span> <span class="pre">2100)</span></code> above shows that the global average temperature was more or less stable in the pre-industrial phase, but steadily increases since the 1990s. It shows further that, depending on the SSP scenario, the course and increase of the global annual temperature differs. While for the best case <code class="docutils literal notranslate"><span class="pre">SSP1-2.6</span></code> scenario, the global annual temperature could stabilize around 15 degC, in the worst case <code class="docutils literal notranslate"><span class="pre">SSP5-8.5</span></code> scenario, the global annual temperature could increase to above 20 degC.</p>
<hr></section>
</section>
<section id="key-messages-to-take-home">
<h2>Key Messages to Take Home üìå<a class="headerlink" href="#key-messages-to-take-home" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>When calculating an ensemble of models, it is best practice to use as many as possible for a more reliable output.</p></li>
<li><p>Before using the ensemble of models, preparation steps include spatial and temporal aggregation of data and possible conversion of units of measure.</p></li>
<li><p>To merge datasets from different models and experiments, additional data dimensions must be created specifying the model and experiment of each dataset.</p></li>
<li><p>Using quantiles instead of ploting all values eases data visualization.</p></li>
</ul>
<hr><p></p>
<span style='float:right'><p style=\"text-align:right;\">This project is licensed under <a href="./LICENSE">APACHE License 2.0</a>. | <a href=\"https://github.com/ecmwf-projects/copernicus-training">View on GitHub</a></span></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/projections-cmip6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../notebook-groups/climate-projections-tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Climate Projections Tutorial</p>
      </div>
    </a>
    <a class="right-next"
       href="../projections-cordex/projections-cordex.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Analysis of Projected versus Historical Climatology with CORDEX Data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning objectives üß†</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#target-audience">Target audience üéØ</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites-and-assumed-knowledge">Prerequisites and assumed knowledge üîç</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outline">Outline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-the-necessary-libraries">1. Import the necessary libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#access-data-with-the-cds-api">2. Access data with the CDS API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unzip-the-downloaded-data-files">3. Unzip the downloaded data files</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-list-of-the-extracted-files">Create a list of the extracted files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-prepare-cmip6-data-for-one-model-and-one-experiment">4. Load and prepare CMIP6 data for one model and one experiment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-load-and-inspect-data">4.A. Load and inspect data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-spatial-aggregation">4.B. Spatial aggregation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-temporal-aggregation">4.C. Temporal aggregation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-conversion-from-kelvin-to-celsius">4.D. Conversion from Kelvin to Celsius</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-create-additional-data-dimensions">4.E. Create additional data dimensions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-prepare-cmip6-data-for-all-models-and-experiments">5. Load and prepare CMIP6 data for all models and experiments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-cmip6-annual-global-average-temperature-between-1850-to-2100">6. Visualize the CMIP6 annual global average temperature between 1850 to 2100</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-calculate-quantiles-for-model-ensemble">6.A. Calculate quantiles for model ensemble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-view-time-series">6.B. View time-series</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-messages-to-take-home">Key Messages to Take Home üìå</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>